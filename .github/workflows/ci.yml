name: Reproduce withastro/docs PR 12358
on:
  - workflow_dispatch
  - push

jobs:
  reproduce:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/setup-node@v5
        with:
          node-version: 22
      - name: Start astro project
        run: npm create astro@latest ./my-project -- --template minimal --yes
      - name: Check project
        run: |
          cd my-project
          # Show Node.js version
          node --version
          # Show TypeScript version
          tsc --version
          # Run TypeScript compiler (should be OK)
          tsc
      - name: Add import alias to tsconfig.json
        run: |
          cd my-project
          # Edit tsconfig.json
          jq '.compilerOptions.paths = {"@components/*": ["src/components/*"]}' tsconfig.json > tsconfig.tmp && mv tsconfig.tmp tsconfig.json
          # Show new tsconfig.json content
          cat tsconfig.json
      - name: Check project again
        run: |
          cd my-project
          # Run TypeScript compiler (fails)
          tsc